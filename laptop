#!/bin/bash

set_base_path() {
  SOURCE="${BASH_SOURCE[0]}"
  DIR="$( dirname "$SOURCE" )"
  while [ -h "$SOURCE" ]
  do
    SOURCE="$(readlink "$SOURCE")"
    [[ $SOURCE != /* ]] && SOURCE="${DIR}/$SOURCE"
    DIR="$( cd -P "$(dirname "$SOURCE")" && pwd )"
  done
  # shellcheck disable=SC2034
  BASE_PATH="$(cd "$DIR" && pwd)"
}

set_base_path

. link_dotfiles

command_exists () {
  type -P "$1" &> /dev/null ;
}

if command_exists brew ; then
  echo -e "\nUpdating Homebrew formula..."
  brew update
else
  echo -e "\nInstalling Homebrew..."
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

brew install git git-lfs bash-completion grc pkgconfig ghostscript imagemagick
brew install openssl
brew install libyaml # should come after openssl
brew install postgresql postgis redis

# Git LFS is a command line extension and specification for managing large files with Git.
git lfs install --force

./cloud66
./projects
./ruby
./node
./bats

echo -e "\nDone."
